<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Dependency Installer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl bg-gray-800 rounded-2xl shadow-2xl p-8 space-y-6">
        <!-- Header -->
        <div class="text-center">
            <h1 class="text-3xl font-bold text-cyan-400">Application Dependency Installer</h1>
            <p class="text-gray-400 mt-2">Download a script to automatically install all required packages and your local project.</p>
        </div>

        <!-- Requirements List (collapsible) -->
        <div>
            <details class="bg-gray-900 rounded-lg p-1">
                <summary class="text-lg font-semibold text-gray-300 cursor-pointer p-3">View Required Packages</summary>
                <div class="p-4 text-sm text-gray-300 max-h-60 overflow-y-auto border-t border-gray-700 mt-2">
                    <pre id="requirements-list">
# Dependencies for Dialogix Application
streamlit
streamlit-chat
streamlit-webrtc
faster-whisper
faiss-cpu
langchain
huggingface-hub
elevenlabs
soundfile
PyPDF2
fpdf2
pyaudio
torch
numpy
noisereduce

# Dependencies for the meta_ai_api library
requests
requests-html
lxml_html_clean
bs4</pre>
                </div>
            </details>
        </div>

        <!-- Installer Download Buttons -->
        <div class="text-center space-y-4 pt-4">
            <h2 class="text-xl font-semibold text-gray-200">Choose your Operating System:</h2>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <button id="windows-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-400">
                    Download for Windows (.bat)
                </button>
                <button id="mac-linux-button" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-green-400">
                    Download for macOS/Linux (.sh)
                </button>
            </div>
        </div>

        <!-- Instructions Section -->
        <div id="instructions" class="hidden fade-in pt-4 text-center">
            <h3 class="text-lg font-semibold text-cyan-400">File Downloaded!</h3>
            <div class="bg-gray-900 rounded-lg p-4 mt-2 text-left text-gray-300">
                <p><strong>Next Steps:</strong></p>
                <ol class="list-decimal list-inside mt-2 space-y-2">
                    <li><strong class="text-yellow-400">IMPORTANT:</strong> Move the downloaded file into your project folder (the same folder that contains your `setup.py` file).</li>
                    <li>Find the file (<code id="filename" class="bg-gray-700 px-1 rounded"></code>) inside your project folder.</li>
                    <li>Double-click the file to run it.</li>
                    <li id="extra-instruction" class="hidden">For macOS/Linux, you might need to give it permission to run. Open your terminal, navigate to your project folder, and type: <code id="permission-command" class="bg-gray-700 p-1 rounded"></code>, then run it with <code id="run-command" class="bg-gray-700 p-1 rounded"></code>.</li>
                    <li>A terminal window will open and install everything. Wait for it to finish.</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const windowsButton = document.getElementById('windows-button');
        const macLinuxButton = document.getElementById('mac-linux-button');
        const requirementsListText = document.getElementById('requirements-list').innerText;
        const instructionsSection = document.getElementById('instructions');
        const filenameElement = document.getElementById('filename');
        const extraInstruction = document.getElementById('extra-instruction');
        const permissionCommandElement = document.getElementById('permission-command');
        const runCommandElement = document.getElementById('run-command');

        // --- Function to get package list ---
        function getPackageList() {
            return requirementsListText
                .split('\n')
                .map(line => line.trim())
                .filter(line => line && !line.startsWith('#'))
                .join(' ');
        }

        // --- Function to trigger file download ---
        function downloadFile(filename, content, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // --- Function to show instructions ---
        function showInstructions(filename, isMacLinux = false) {
            filenameElement.textContent = filename;
            if (isMacLinux) {
                permissionCommandElement.textContent = `chmod +x ${filename}`;
                runCommandElement.textContent = `./${filename}`;
                extraInstruction.classList.remove('hidden');
            } else {
                extraInstruction.classList.add('hidden');
            }
            instructionsSection.classList.remove('hidden');
        }

        // --- Event Listener for Windows Button ---
        windowsButton.addEventListener('click', () => {
            const packages = getPackageList();
            const filename = 'install_dependencies.bat';
            // Batch script content
            const scriptContent = `@echo off
echo Installing Python package dependencies...
echo This may take a few minutes.
pip install ${packages}
echo.
echo Installing local project from setup.py...
pip install .
echo.
echo Installation complete! You can close this window.
pause`;
            downloadFile(filename, scriptContent, 'application/x-bat');
            showInstructions(filename);
        });

        // --- Event Listener for macOS/Linux Button ---
        macLinuxButton.addEventListener('click', () => {
            const packages = getPackageList();
            const filename = 'install_dependencies.sh';
            // Shell script content
            const scriptContent = `#!/bin/bash
echo "Installing Python package dependencies..."
echo "This may take a few minutes."
pip install ${packages}
echo ""
echo "Installing local project from setup.py..."
pip install .
echo ""
echo "Installation complete!"
read -p "Press Enter to exit..."`;
            downloadFile(filename, scriptContent, 'application/x-sh');
            showInstructions(filename, true);
        });
    </script>

</body>
</html>
